{% extends 'base.html' %}
{% load static %}
{% block css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css'%}">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.3/css/dataTables.bootstrap5.min.css">
{% endblock %}


{% block content %}
<section class="main-admin d-block ">
{% include 'navegacion.html'%}
<div class="d-flex justify-content-center">
<div class="container d-flex justify-content-center row">
    <!--MENU DE LA IZQUIERDA-->
    <div class="OptionAdmin card ms-auto col-md-3 text-start my-5 position-sticky">
      <ul class="list-group list-group-flush mt-">
    <!--PERFIL ADMIN LINKS-->
    <li class="list-group-item ">
      <a class="active" href="{% url 'main-admin' %}"><i class="fas fa-home"></i>Home</a>
    </li>
    <li class="list-group-item ">
      <a class="active" href="{{request.user.get_absolute_url}}"><i class="far fa-user"></i> Mi perfil</a>
    </li>
    <li class="list-group-item ">
      <a href="{% url 'logout' %}"><i class="fas fa-sign-out-alt"></i> Salir</a>
    </li>
    </ul>
  </div>

      <div class="AdminPro col-md-9 text-center my-5">


        <!--PROYECTOS-->
        <h2 class="mb-5"> Proyectos</h2>
        {% if object_list %}
        <div class="d-flex justify-content-start row row-cols-1 row-cols-md-3 row-cols-lg-3  row-cols-xl-4 g-4">
          {% for projecto in object_list %}
          
          <div class="col d-flex align-items-stretch justify-content-center mb-5">
            <a href="{{projecto.get_absolute_url}}" style="text-decoration: none;">
            <div class="card text-light bgcolor3">
              <div class="card-body">
                <h3 class="card-title">{{projecto.nombre_clave}}</h3>
                <div class="d-inline-block d-flex justify-content-start float-left">
                  <span class="pe-2"><i class="far fa-clock me-1"></i>{{projecto.fecha_final|date:"d M"}}</span><span class="pe-2"><i class="fas fa-user-friends me-1"></i>{{projecto.miembros.all.count}}</span><span class="pe-1"><i class="far fa-check-square me-1"></i>{{projecto.get_tareascomp}}/{{projecto.get_numtareas}}</span>
                </div>
              </div>
            </div>
          </a>
          </div>

          {% endfor %}

          <div class="col d-flex align-items-stretch justify-content-center  justify-content-md-start ">
            <a href="{% url 'projecto-create' %}">
            <div class="card text-light bg-light">
              <div class="card-body d-flex align-items-middle">
                <h3 class="card-body my-auto"><i class="fas fa-plus text-secondary"></i></h3>
                </div>
              </div>
            </a>
          </div>

          </div>
          {% else %}
        <div class="col-md-12 text-center"><img src="{% static 'img/empty-projects.svg'%}" style="width: 30%;"/> <h3 class="text-muted mt-3">No tienes proyectos por el momento.</h3></div>

        {% endif %}


          <!--ENDPROJECTOS-->



            <!--TAREAS-->
            <h2 class="mb-5 mt-3"> Tareas</h2>
          {% if tareas %}
          <div class="d-flex justify-content-start row row-cols-1 row-cols-md-3 row-cols-lg-3  row-cols-xl-4 g-4">
            {% for tarea in tareas %}
            <a href="{{tarea.get_absolute_url}}" style="text-decoration: none;">
            <div class="col d-flex align-items-stretch justify-content-center">
              <div class="card text-light bgcolor3">
                <div class="card-body">
                  <h3 class="card-title">{{tarea.nombre}}</h3>
                  <div class="d-inline-block d-flex justify-content-start float-left">
                    <span class="pe-2"><i class="far fa-clock me-1"></i>{{tarea.fecha_finest|date:"d M"}}</span><span class="pe-2"><i class="fas fa-user-friends me-1"></i>{{tarea.miembros.all.count}}</span><span class="pe-2"><i class="fas fa-file-alt me-1"></i>{{tarea.get_estado_display}}</span>
                  </div>
                </div>
              </div>
            </div>
          </a>
  

            {% endfor %}

            </div>
            {% else %}

            <div class="col-md-12 text-center"><img src="{% static 'img/bomba.svg'%}" style="width: 30%;" /> <h3 class="text-muted mt-3">No tienes tareas por el momento.</h3></div>

          {% endif %}

            <!--ENDTAREAS-->

             <!--FICHA EMPLEADO-->
             <h2 class="mb-5 mt-3"> Empleados</h2>
             <div class="container-fluid px-0 mx-0">
              <table id="empleadosTable" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nombres</th>
                        <th>Apellidos</th>
                        <th>Identificacion</th>
                        <th>Dirección</th>
                        <th>Teléfono</th>
                        <th>Correo Electrónico</th>
                        <th>Fecha de contratacion</th>
                        <th>Editar</th>
                        <th>Eliminar</th>
                    </tr>
                </thead>
                <tbody>
                  {% for trabajador in trabajadores %}
                    <tr>
                        <td>{{trabajador.pk}}</td>
                        <td>{{trabajador.first_name}}</td>
                        <td>{{trabajador.last_name}}</td>
                        <td>{{trabajador.username}}</td>
                        <td>{{trabajador.direccion}}</td>
                        <td>{{trabajador.telefono}}</td>
                        <td>{{trabajador.email}}</td>
                        <td>{{trabajador.incorporado}}</td>
                        <td><a href="{% url 'user-update' trabajador.slug %}"><i class="fa fa-pencil"/></a></td>
                        <td><a href=""><i class="fa fa-trash"/></a></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
          </div>
        </div>

</div>

</div>
</div>
</section>

{% endblock %}

{% block script %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.3/js/dataTables.bootstrap5.min.js"></script>
<script>
let table = new DataTable('#empleadosTable', {
  "scrollX": true,
  "ordering": true,
  "lengthMenu": [[5,10,25], [5, 10, 25]],
  "columnDefs": [
    { orderable: false, targets: [8,9] }
]
  
});
</script>
{% endblock %}